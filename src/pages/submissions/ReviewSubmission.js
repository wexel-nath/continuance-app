import React, { useState, useEffect } from "react";
import { camelizeKeys as toCamelCase } from "humps";

import Container from "@material-ui/core/Container";

import Loader from "../../components/helper/Loader";
import ReviewCard from "../../components/submissions/ReviewCard";
import { getSubmissionById } from "../../api/continuance";

const useSubmission = submissionId => {
  const [submission, setSubmission] = useState({});
  const [loading, setLoading] = useState(true);

  const getSubmission = async () => {
    const {
      data: { data }
    } = await getSubmissionById(submissionId);

    setSubmission(toCamelCase(data));
    setLoading(false);
  };

  useEffect(() => {
    getSubmission();
  }, []);

  return [submission, loading];
};

const criteria = [
  {
    key: "originality",
    title: "Originality, High Concept, Point of difference",
    description:
      "Does it have interesting new dialogue, or exciting hook, or shooting style? - All shot one take or on iPhones etc. or conceptually original, or potential to have one reworked within 2 months of rewrites?"
  },
  {
    key: "viability",
    title: "Market Viability",
    description:
      "* Australian Market - Is it for Women over 40’s? (As that is all Aussie distributors are really after) If not does it suit:\n* Asian Market - Does it have Asian elements or an Asian star that will be recognizable? Or:\n* US market - Does it have a strong enough point of difference to play at Sundance or are the roles interesting enough to attract A-list actors? Or:\n* Is it based on pre-existing successful material? Short film, best selling or awarded book, webseries, comic book?"
  },
  {
    key: "socialTrend",
    title: "Social Message Trend",
    description:
      "Female protagonist, Sexuality – LGBTQI, Immigration, Diversity etc."
  },
  {
    key: "structure",
    title: "Structure",
    description:
      "Does it follow a filmic structure or knowingly break the rules? Should have a clearly defined Inciting incident, dramatic tension, character arc, midpoint, climax, and ending. How long would it take to get these in place?"
  },
  {
    key: "characters",
    title: "Characters",
    description:
      "Are the characters compelling, creatively handled through dialogue and action, and do they have clear objectives?"
  },
  {
    key: "stakes",
    title: "Stakes",
    description:
      "Is the protagonist an active character? (Not being affecting by random occurrences) and does the antagonist or circumstance provide stakes on a surface, emotional, & philosophical level? How long would it take to get them in place?"
  },
  {
    key: "dialog",
    title: "Dialogue",
    description:
      "Does it feel suited to the character and interesting? Is it overtly expositional or clunky? How long would it take to fix it?"
  },
  {
    key: "cost",
    title: "Cost to make film",
    description:
      "* Below $500K – 5 points (1 or 2 locations and limited cast)\n* Below $1M – 4 points\n* Below $3M – 3 points\n* Below $5M – 2 points\n* Below $10M – 1 point (Multiple Locations, VFX, Cast)\n* This needs to be discussed further with producers, but take a stab"
  }
];

const ReviewSubmission = ({ match }) => {
  const submissionId = match.params.id;
  const [submission, loading] = useSubmission(submissionId);

  return (
    <Container maxWidth="lg">
      {loading && <Loader text="Loading" />}
      <ReviewCard criteria={criteria} submission={submission} />
    </Container>
  );
};

export default ReviewSubmission;
